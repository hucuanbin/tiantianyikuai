(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-08273e30"],{"7f4f":function(e,t,a){"use strict";a.d(t,"b",(function(){return m})),a.d(t,"a",(function(){return g}));var r=a("8a05"),n={upload:"/scheduling/upload",importFile:"/scheduling/upload-confirm",fileList:"/scheduling/upload-result",export:"/scheduling/list/export",schedulingList:"/scheduling/list",schedulingDetails:"/scheduling/detail",uploadTemplate:"/scheduling/upload-template"};function i(e){return Object(r["c"])({url:n.uploadTemplate,params:e,method:"get",responseType:"blob",timeout:12e4})}function o(e){return Object(r["c"])({url:n.export,params:e,method:"get",responseType:"blob",timeout:12e4})}function s(e){return Object(r["c"])({url:n.importFile,data:e,method:"post"})}function l(e){return Object(r["c"])({url:n.fileList,params:e,method:"get"})}function c(e){return Object(r["c"])({url:n.upload,data:e,method:"post"})}function d(e){return Object(r["c"])({url:n.schedulingList,params:e,method:"get"})}function u(e){return Object(r["c"])({url:n.schedulingDetails,params:e,method:"get"})}var m={upload:c,importFile:s,fileList:l,schedulingList:d,schedulingDetails:u,uploadTemplate:i,schedulingExport:o},p={list:"/bus",export:"/bus/export"},f=function(e){return Object(r["c"])({url:p.list,params:e,method:"get"})},b=function(e){return Object(r["c"])({url:p.export,params:e,responseType:"blob",timeout:12e4,method:"get"})},g={busList:f,busExport:b}},c53d:function(e,t,a){"use strict";a.r(t);var r,n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"table-common order"},[a("div",{staticClass:"header"},[a("div",{staticClass:"form-box"},[a("div",{staticClass:"form-item"},[a("a-upload",{attrs:{disabled:e.uploadLoading,accept:".xls,.xlsx",beforeUpload:e.beforeUpload,showUploadList:!1,customRequest:e.handleUpload}},[a("a-button",{attrs:{size:"large",loading:e.uploadLoading}},[e._v(" 上传 ")])],1)],1),e.file?a("div",{staticClass:"form-item"},[a("a-alert",{staticClass:"flex flex-center",attrs:{type:e.file.status}},[a("div",{staticClass:"file-name",attrs:{slot:"message"},slot:"message"},[e._v(" "+e._s(e.file.name)+" ")])])],1):e._e()]),a("div",{staticClass:"button-box"},[a("a-tooltip",{staticClass:"form-button",attrs:{title:e.file?e.errorFlag?"请处理完错误后，重新上传文件":"":"成功上传排班后，才可导入系统"}},[a("a-button",{staticClass:"downButton",attrs:{size:"large",type:"primary",disabled:!e.file||!!e.errorFlag,loading:e.importLoading},on:{click:e.importFile}},[e._v(" 导入 ")])],1),a("a-button",{staticClass:"form-button",attrs:{size:"large",loading:e.excelLoading},on:{click:e.uploadTemplate}},[e._v(" 下载模板 ")])],1)]),a("div",{staticClass:"table"},[a("a-table",{staticClass:"table-border-bottom table-scrollbar common-modal-box",attrs:{columns:e.scaleColumns,"data-source":e.tableList,pagination:e.pagination,scroll:e.tableScroll,loading:e.getTableListLoading,rowKey:function(e){return""+e.index}},on:{change:e.pageChange},scopedSlots:e._u([{key:"tr",fn:function(t){return[t&&t.error?a("div",[a("a-tooltip",{attrs:{title:t.error}},[a("span",{},[e._v(e._s(t.value))])])],1):a("div",[e._v(e._s(t))])]}},{key:"errorInfo",fn:function(t){return[t?a("div",{staticClass:"error-msg"},[e._v(" "+e._s(t)+" ")]):a("div",[e._v(e._s(t))])]}}])})],1)])},i=[],o=a("5530"),s=a("1da1"),l=a("ade3"),c=(a("9a33"),a("f933")),d=(a("ab9e"),a("2c92")),u=(a("eb14"),a("39ab")),m=(a("c68a"),a("0020")),p=(a("96cf"),a("b0c0"),a("4de4"),a("d81d"),a("a15b"),a("07ac"),a("b64b"),a("d3b7"),a("ac1f"),a("841c"),a("ca00")),f=a("3b98"),b=a("72ed"),g=a("7f4f"),h=a("c1df"),x=a.n(h),v=function(e,t,a){var r=t[e],n="ant-table-row-cell-break-word";return r&&r.error&&(n+=" error-td"),{domProps:{className:n}}},j={name:"Order",data:function(){var e=[{customCell:v.bind(this,"index"),scopedSlots:{customRender:"tr"},title:"序号",dataIndex:"index",key:"index",width:72,align:"center"},{customCell:v.bind(this,"stationName"),scopedSlots:{customRender:"tr"},title:"场站",dataIndex:"stationName",key:"stationName",width:135,align:"center"},{customCell:v.bind(this,"jobName"),scopedSlots:{customRender:"tr"},title:"岗位",dataIndex:"jobName",key:"jobName",width:135,align:"center"},{customCell:v.bind(this,"groupName"),scopedSlots:{customRender:"tr"},title:"组别 ",dataIndex:"groupName",key:"groupName",width:135,align:"center"},{customCell:v.bind(this,"date"),scopedSlots:{customRender:"tr"},title:"日期",dataIndex:"date",key:"date",width:135,align:"center"},{customCell:v.bind(this,"adminName"),scopedSlots:{customRender:"tr"},title:"组长",dataIndex:"adminName",key:"adminName",width:135,align:"center"},{customCell:v.bind(this,"memberName"),scopedSlots:{customRender:"tr"},title:"值班人员",dataIndex:"memberName",key:"memberName",width:135,align:"center"},{scopedSlots:{customRender:"errorInfo"},title:"错误原因",dataIndex:"allErrorText",key:"allErrorText",width:260,align:"center"}];return{initColumns:e,importLoading:!1,excelLoading:!1,errorFlag:0,isTableFilterTime:!1,uploadLoading:!1,file:void 0}},mixins:[f["a"],b["a"]],components:(r={},Object(l["a"])(r,m["a"].name,m["a"]),Object(l["a"])(r,u["a"].name,u["a"]),Object(l["a"])(r,d["a"].name,d["a"]),Object(l["a"])(r,c["a"].name,c["a"]),r),computed:{},methods:{getTableList:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var r,n,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(r=t.filters.id,r){a.next=3;break}return a.abrupt("return",!1);case 3:return e.id=r,e.filter=void 0,n=0,a.next=8,g["b"].fileList(e);case 8:return i=a.sent,i.data.list=i.data.list.map((function(e){return e.date=x()(e.date).format("YYYY-MM-DD"),e.allErrorText=Object.values(e.errorInfo).join("#"),n+=Object.values(e.errorInfo).length,Object.keys(e.errorInfo).map((function(t){var a=e.errorInfo[t];e[t]={value:e[t],error:a}})),e})).filter((function(e){return 0===n||e.allErrorText})),t.errorFlag=n,a.abrupt("return",i.data);case 12:case"end":return a.stop()}}),a)})))()},beforeUpload:function(e){return this.file={name:e.name,size:e.file,status:"warning",loading:!0,formData:e},!0},handleUpload:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:a=e,r=e.file,n=new FormData,n.append("file",r.formData),e.uploadLoading=!0,g["b"].upload(n).finally((function(t){e.uploadLoading=!1})).then((function(e){a.file=Object(o["a"])(Object(o["a"])({},a.file),{},{status:"success",loading:!0}),a.filters.id=e.data.id,a.search()})).catch((function(e){a.file=Object(o["a"])(Object(o["a"])({},a.file),{},{status:"error",loading:!0})}));case 6:case"end":return t.stop()}}),t)})))()},search:function(){this.requestTableList({current:1})},importFile:function(){var e=this;e.importLoading=!0,g["b"].importFile({id:this.filters.id}).then((function(t){e.importLoading=!1,e.file=void 0,e.$message.success("导入系统成功")})).catch((function(t){e.importLoading=!1}))},uploadTemplate:function(){var e=this;e.excelLoading=!0,g["b"].uploadTemplate(this.pagination).then((function(e){return e instanceof Blob&&"application/json"!==e.type?(Object(p["b"])("排班模板.xlsx",e),!0):e.text()})).then((function(t){if(t&&"string"===typeof t){var a=JSON.parse(t);e.$message.error("导出失败：".concat(a.message))}e.excelLoading=!1})).catch((function(t){e.$message.error("导出失败"),e.excelLoading=!1}))}},created:function(){},beforeDestroy:function(){}},L=j,w=(a("df30"),a("2877")),O=Object(w["a"])(L,n,i,!1,null,"74fbfec4",null);t["default"]=O.exports},df30:function(e,t,a){"use strict";a("e697")},e697:function(e,t,a){}}]);